IV. Анализ и поиск в файле DOCX
Эксперимент проводился на компьютере под управление операционной системы Windows 8. Её параметры приведены в Таблице 2. Чтобы не подвергать опасности хост, для поиска вредоносного кода использовалась виртуальная машина.

Таблица 3 содержит данные о наборах тестовых файлов. Среди них было 25 файлов DOCX в качестве датасета и 57 файлов примеров. Эти файлы были скачаны с разных сайтов и Гугла.

V. Фильтр документов DOCX
Существует много исследований о скрытии данных, однако мало кто использует структуру XML в файлах DOCX. [несмотря на сложность DOCX, он встречает некоторые угрозы вследствие архивирования]. После того как  структура файла разобрана, хакер может встраивать эксплойты, чтобы обойти систему безопасности. Фильтр DOCX был разработан, чтобы классифицировать файлы на основе ключевых слов. Эта система анализирует структуру документа и извлекает подозрительные элементы. По итогу мы получаем отчёт, является ли исследуемый файл вредоносным или безвредным.

Работа фильтра состоит из двух фаз:
1) Фаза сканирования структуры
Основные действия представлены на Рисунке 7. Структура сканируется на предмет наличия ключевых слов, заданных в отдельном файле пользователем. После этого от документа и от файла с ключевыми словами берутся MD5-хэши.

Для упрощения анализа файл DOCX читается последовательно. В этом примере мы анализируем встроенный в документ файл. Файл проверяется на наличие ключевых слов:
- OLE и o:lock
- Vanish

Главной задаче сканирования является извлечение различных элементов, находящихся в документе. Для этого используются регулярные выражения.
Система начнёт поиск ключевых слов, которые напрямую не связаны с файлами. В конце будет выдан отчёт, является ли исследуемый файл вредоносным, безвредным или подозрительным.

2) Фаза фильтрации DOCX
Основные действия представлены на Рисунке 8. Система вычисляет хэш от исследуемого файла и ищет его в базе данных. Если он не обнаружен, то добавляется в неё. Если обнаружен - значит файл сканировался ранее.

А. Чтение и Анализ
Чтение документа, сканирование структуры, поиск ключевых слов и вычиследние хэша.

Б. Вычисление хэша
В первую очередь система вычисляет хэши для всех исследуемых файлов вместе с ключевыми значениями, извлеченными из этих файлов. Впоследствии эти данных будут использоваться для идентификации и классификации примеров малвари и внутренних элементов DOCX. Также это позволяет узнать, анализировался ли данный файл ранее. После сканирования пользователь может выбрать формат вывода отчёта: вывод на консоль или сохранение в файл. Файл при этом имеет такое же имя, как и исследуемый документ.